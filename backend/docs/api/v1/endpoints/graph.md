# Graph API Endpoints

This section covers the API endpoints related to exporting graph triples from tables in the Knowledge Table backend. These endpoints allow you to generate triples (subject, predicate, object) based on structured data in tables and export the results as a JSON file.

## Available Endpoint

1. **POST** `/graph/export-triples` â€“ Export triples from a table.

For detailed API schemas and auto-generated documentation, refer to:

::: app.api.v1.endpoints.graph

---

## POST `/graph/export-triples`

### Overview

This endpoint exports triples (subject, predicate, object) from a table based on the provided data. The results are returned as a JSON file containing both the triples and additional chunks of extracted data.

### Request

- **Method**: `POST`
- **URL**: `/graph/export-triples`
- **Headers**:
  - `Authorization`: Bearer token (if required)
  - `Content-Type`: `application/json`
- **Body**: The request body should be a JSON object representing a table with columns, rows, and cells.

#### Example Request

```bash
curl -X POST "https://api.example.com/v1/graph/export-triples" \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
        "columns": ["Column1", "Column2", "Column3"],
        "rows": ["Row1", "Row2"],
        "cells": [
          {"column": "Column1", "row": "Row1", "value": "Data1"},
          {"column": "Column2", "row": "Row1", "value": "Data2"},
          {"column": "Column1", "row": "Row2", "value": "Data3"},
          {"column": "Column2", "row": "Row2", "value": "Data4"}
        ]
      }'
```

#### Body Fields

- `columns`: A list of column names for the table.
- `rows`: A list of row names for the table.
- `cells`: A list of cell objects, where each object contains:
  - `column`: The name of the column this cell belongs to.
  - `row`: The name of the row this cell belongs to.
  - `value`: The value contained in this cell.

### Response

- **Status**: 200 OK
- **Content-Type**: application/json

The response will contain a JSON file attachment with the triples and chunks extracted from the table.

#### Example Response

```json
{
  "triples": [
    {
      "subject": "Subject1",
      "predicate": "Predicate1",
      "object": "Object1"
    },
    {
      "subject": "Subject2",
      "predicate": "Predicate2",
      "object": "Object2"
    }
  ],
  "chunks": [
    {
      "start": 0,
      "end": 100,
      "text": "Extracted text chunk 1"
    },
    {
      "start": 101,
      "end": 200,
      "text": "Extracted text chunk 2"
    }
  ]
}
```

### Error Codes

- `400 Bad Request`: Invalid JSON in the request body.
- `422 Unprocessable Entity`: Validation error in the request data (e.g., missing fields or invalid format).
- `500 Internal Server Error`: An unexpected error occurred during the export process.

## How it Works

1. The system receives the table structure (columns, rows, cells) in the request body.
2. The service validates the table and ensures the data is correctly formatted.
3. Using a Language Model (LLM) service, the system generates a schema for the table.
4. Based on the schema, the service generates triples (subject, predicate, object) and extracts data chunks.
5. The response contains the generated triples and chunks in JSON format, downloadable as a file.

## Notes

For further details on request/response schemas and more advanced interactions, see the interactive API documentation generated by FastAPI.